<ion-header>
  <ion-navbar>
    <ion-title>
      订单反馈处理
    </ion-title>
  </ion-navbar>
  <div class="nav_pet_header">
    <ion-segment [(ngModel)]="pet">
      <ion-segment-button value="no" (click)="changeType(0)">
        未处理
        <span></span>
      </ion-segment-button>
      <ion-segment-button value="wait" (click)="changeType(2)">
        待处理
        <span></span>
      </ion-segment-button>
      <ion-segment-button value="ok" (click)="changeType(1)">
        已处理
        <span></span>
      </ion-segment-button>
    </ion-segment>
  </div>
</ion-header>

<div [@showAlertWrapper]="promptFlag" class="operative-task-feedback_prompt"
     ontouchmove="event.preventDefault();event.stopPropagation();">
  <div class="wrapper"></div>
  <ion-list [@showAlert]="promptFlag" class="content">
    <ion-item class="_item">
      <ion-textarea [(ngModel)]="data.unDesc" maxlength="50" [placeholder]="data.placeholder"></ion-textarea>
    </ion-item>
    <div class="btn">
      <button (click)="promptFlag='back'" ion-button clear>取消</button>
      <button (click)="promptSubmit()" ion-button clear>确定</button>
    </div>
  </ion-list>
</div>

<ion-content class="operative-task-feedback" [ngSwitch]="pet">
  <ion-refresher
    (ionRefresh)="doRefresh($event)" pullMax="100">
    <ion-refresher-content refreshingText='刷新中...'>
    </ion-refresher-content>
  </ion-refresher>
  <ion-list *ngSwitchCase="'no'" class="wrapper">
    <p class="point">总计<span>{{total}}</span>条</p>
    <ion-card *ngFor="let order of list; let i = index">
      <div class="info">
        <span>订单号</span>
        <span class="text">{{order.orderNo}}</span>
      </div>
      <div class="info" *ngIf="order.feedBackTime">
        <span>反馈时间</span>
        <span class="text">{{order.feedBackTime}}</span>
      </div>
      <div class="info" *ngIf="order.productName">
        <span>商品</span>
        <span class="text">{{order.productName}}</span>
      </div>
      <div class="info" *ngIf="order.feedbackDes">
        <span>反馈内容</span>
        <span class="text">{{order.feedbackDes}}</span>
      </div>
      <div class="info" *ngIf="order.userMobile">
        <span>用户电话</span>
        <CommonPhone [phone]="order.userMobile"></CommonPhone>
      </div>
      <div class="btn">
        <button (click)="showPrompt(order,i,'2')" ion-button clear>转客服</button>
        <button (click)="showPrompt(order,i,'1')" ion-button clear>处理完毕</button>
      </div>
    </ion-card>
  </ion-list>
  <ion-list *ngSwitchCase="'wait'" class="wrapper">
    <p class="point">总计<span>{{total}}</span>条</p>
    <ion-card *ngFor="let order of list; let i = index">
      <div class="info">
        <span>订单号</span>
        <span class="text">{{order.orderNo}}</span>
      </div>
      <div class="info" *ngIf="order.feedBackTime">
        <span>反馈时间</span>
        <span class="text">{{order.feedBackTime}}</span>
      </div>
      <div class="info" *ngIf="order.productName">
        <span>商品</span>
        <span class="text">{{order.productName}}</span>
      </div>
      <div class="info" *ngIf="order.feedbackDes">
        <span>反馈内容</span>
        <span class="text">{{order.feedbackDes}}</span>
      </div>
      <div class="info" *ngIf="order.undealName">
        <span>处理人</span>
        <span class="text">{{order.undealName}}</span>
      </div>
      <div class="info" *ngIf="order.unDesc">
        <span>待处理说明</span>
        <span class="text">{{order.unDesc}}</span>
      </div>
      <div class="info" *ngIf="order.userMobile">
        <span>用户电话</span>
        <CommonPhone [phone]="order.userMobile"></CommonPhone>
      </div>
      <div class="btn">
        <button (click)="showPrompt(order,i,'2')" ion-button clear>修改</button>
        <button (click)="showPrompt(order,i,'1')" ion-button clear>处理完毕</button>
      </div>
    </ion-card>
  </ion-list>
  <ion-list *ngSwitchCase="'ok'" class="wrapper">
    <p class="point">总计<span>{{total}}</span>条</p>
    <ion-card *ngFor="let order of list; let i = index">
      <div class="info">
        <span>订单号</span>
        <span class="text">{{order.orderNo}}</span>
      </div>
      <div class="info" *ngIf="order.feedBackTime">
        <span>反馈时间</span>
        <span class="text">{{order.feedBackTime}}</span>
      </div>
      <div class="info" *ngIf="order.productName">
        <span>商品</span>
        <span class="text">{{order.productName}}</span>
      </div>
      <div class="info" *ngIf="order.feedbackDes">
        <span>反馈内容</span>
        <span class="text">{{order.feedbackDes}}</span>
      </div>
      <div class="info" *ngIf="order.unDesc">
        <span>待处理说明</span>
        <span class="text">{{order.unDesc}}</span>
      </div>
      <div class="info" *ngIf="order.undealName">
        <span>处理人</span>
        <span class="text">{{order.undealName}}</span>
      </div>
      <div class="info" *ngIf="order.desc">
        <span>处理说明</span>
        <span class="text">{{order.desc}}</span>
      </div>
      <div class="info" *ngIf="order.userMobile">
        <span>用户电话</span>
        <CommonPhone [phone]="order.userMobile"></CommonPhone>
      </div>
    </ion-card>
  </ion-list>
  <ion-infinite-scroll *ngIf="list.length !== total"
                       (ionInfinite)="doInfinite($event)">
    <ion-infinite-scroll-content loadingText="努力加载中...">
    </ion-infinite-scroll-content>
  </ion-infinite-scroll>
  <p class="no-data" *ngIf="list.length === total">
    {{list.length === 0 ? '没有相关订单~' : '没有更多订单了~'}}</p>
</ion-content>

